{% extends "base.html" %}
{% block content %}
<!---
    <div id="app">
        <video id="video_content" width="960" height="720" :src="'/media/' + article.id + '/' + article.movie_name" :poster="'/media/' + article.id + '/thumb.jpg'" controls></video>
        [[article.created_at|time_format]]
    </div>
-->
    <div id="app">
        <header>
          <div class="header">
            <h1 class="title">Eresolve</h1>
                <nav class="nav">
            <div class="post">
                <span></span>
                <button class="post-article" @click="toUpload()">投稿する<span class="triangle-post"></span></button>
            </div>
            <div>
                <input type="text" class="search" v-model="search" value="キーワードを入力">
            </div>
            <div>
              <button class="doSearch" @click="tosearch" >検索する</button>
            </div>
            <div class="account" @click="showMenu">
                アカウント
                <span class="triangle-account"></span>
            </div>
                </nav>
                <div class="modal" v-if="menu">
                  <button class="logout" @click="logout">ログアウト</button>
              </div>
          </div>
        </header>
          <div class="main">
              <div class="articles">
                    <div class="article">
              <div class="title-section">
                        <h1 class="article__title">[[ article.title ]]</h1>
                        <div class="date">[[ article.created_at|time_format ]]</div>
                              <div class="article__tags">
                  <div class="tag" v-for="tag in tags">[[ tag ]]</div>
                </div>
              </div>
                          <div class="lgtm-button">
                <button class="lgtm" @click="calculatelgtmCount" :class="{ isPushed : lgtm }">LGTM</button><span class="lgtm-count">[[ lgtmCount ]]</span>
                        </div>
              <div class="article__text" v-html="content_html">
                <!--[[ article.content_html ]]-->
              </div>
                  </div>
                      <video id="video_content" width="500px" height="300" :src="'/media/' + article.id + '/' + article.movie_name" :poster="'/media/' + article.id + '/thumb.jpg'" controls></video>
              </div>
          </div>
    </div>
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/locale/ja.js"></script>
    <script>
        var vm = new Vue({
            delimiters: ['[[', ']]'],
            el: '#app',
            data: {
               keyword:"",
               menu:false,
               article: null,
               content_html: "",
               //title: 'タイトルタイトルタイトル',
			   //content: 'テキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキストテキスト',
			   search: '',
			   lgtm: false,
			   lgtmCount: 0,
			   tags: [ 'python', 'python' ],
			   //date: '2021/02/20',
			   isPushed: false
            },
            methods: {
                window:onload = function() {

                    axios.get("{% url 'error_resolve_app:detail_article'%}")//ここでDjangoに送信
                    .then(function (response) { 
                          vm.article = response.data;//response.dataに詳細を表示させたいarticleが入っている
                          vm.content_html = response.data["content_html"]
                        
                        })
                        
                        .catch(function (error) {
                            console.log(error);
                        })
                        .then(function () {
                        });


                    },
                    toUpload() {
                      location.href = `/article_upload/` 
                    },
                    tosearch() {
                    console.log("oooo");
                    location.href = `/article_result/?keyword=${this.search}`;
                },
                logout() {
                    location.href = `/accounts/logout/`;
                },
                showMenu() {
                console.log("ok");
                    this.menu = !this.menu;
                    console.log(this.menu);
                }

            },
            filters: {//日本時間に直す
                time_format: function (date) {
                    return moment(date).format('YYYY/MM/DD HH:mm');// eslint-disable-line
                }
            },
        });
    </script>
    <style>
        html, body, div, span, object, iframe,
        h1, h2, h3, h4, h5, h6, p, blockquote, pre,
        abbr, address, cite, code,
        del, dfn, em, img, ins, kbd, q, samp,
        small, strong, sub, sup, var,
        b, i,
        dl, dt, dd, ol, ul, li,
        fieldset, form, label, legend,
        table, caption, tbody, tfoot, thead, tr, th, td,
        article, aside, canvas, details, figcaption, figure,
        footer, header, hgroup, menu, nav, section, summary,
        time, mark, audio, video {
          margin:0;
          padding:0;
          border:0;
          outline:0;
          vertical-align:baseline;
          background:transparent;
        }
        
        body {
          /* プロジェクトによって変動 */
          min-width: 1000px;
          color: #000;
          line-height: 1.6;
          font-weight: 400;
          font-family: 'ヒラギノ角ゴ ProN W3', 'Hiragino Kaku Gothic ProN', 'YuGothic', '游ゴシック', 'メイリオ', Meiryo, -apple-system, BlinkMacSystemFont, 'Helvetica Neue', Arial, sans-serif;
         
          width: 100%;
          font-smoothing: antialiased;
          font-variant-numeric: tabular-nums;
          /* safari hover対策 */
          -webkit-font-smoothing: antialiased;
        }
        
        article,aside,details,figcaption,figure,
        footer,header,hgroup,menu,nav,section {
          display:block;
        }
        
        ul, ol {
          list-style:none;
        }
        
        blockquote, q {
          quotes:none;
        }
        
        blockquote:before, blockquote:after,
        q:before, q:after {
          content:'';
          content:none;
        }
        
        a {
          margin:0;
          padding:0;
          vertical-align:baseline;
          text-decoration: none;
          color: inherit;
        }
        
        /* change colours to suit your needs */
        ins {
          background-color:#ff9;
          color:#000;
          text-decoration:none;
        }
        
        /* change colours to suit your needs */
        mark {
          background-color:#ff9;
          color:#000;
          font-style:italic;
          font-weight:bold;
        }
        
        del {
          text-decoration: line-through;
        }
        
        abbr[title], dfn[title] {
          border-bottom:1px dotted;
          cursor:help;
        }
        
        table {
          border-collapse:collapse;
          border-spacing:0;
        }
        
        /* change border colour to suit your needs */
        hr {
          display:block;
          height:1px;
          border:0;
          border-top:1px solid #cccccc;
          margin:1em 0;
          padding:0;
        }
        
        input, select {
          vertical-align:middle;
        }
        
        img {
          vertical-align: bottom;
          line-height: 1.0;
        }
        
        button {
          line-height: 1.0;
          background-color: transparent;
          border: none;
          cursor: pointer;
          outline: none;
          padding: 0;
          appearance: none;
        }
        body {
          margin: 0;
          padding: 0;
          background-color: #E5E5E5;
        }
        header {
          width: 100%;
          height: 60px;
          background-color: #4CA4D0;
        }
        .header {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        .title {
          font-size: 30px;
          padding: 5px 10px 10px 50px;
          color: white;
        }
        .nav {
          display: flex;
          justify-content: space-around;
          align-items: center;
          width: 40%;
          margin-right: 10px;
        }
        .post {
          margin-right: 20px;
        }
        .post-article {
          color: rgb(255, 255, 255);
          font-weight: 600;
          font-size: 18px;
          background-color: #1587d3;
          width: 120%;
          padding: 10px;
          border-radius: 7px;
          box-shadow: 0 0 8px Gray;
        }
        .post-article:hover {
          background-color: #2c7cb1;
        }
        .post-article:active {
          box-shadow: none;
        }
        .search {
            width: 100%;
            height: 20px;
            border-radius: 7px;
        }
        .account {
            color: rgb(255, 255, 255);
            font-size: 18px;
            font-weight: 400;
        }
        .triangle-post,
        .triangle-account {
            width: 0;
          height: 0;
          border-left: 7px solid transparent;
          border-right: 7px solid transparent;
          border-top: 7px solid #fff;
            position: relative;
            top: 15px;
        }
        .triangle-post {
            margin-left: 5px;
        }
        .main {
            width: 85%;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .devide {
            margin: 0 auto;
            width:90%;
            height: 1px;
            background-color: gray;
        }
        .tag {
            width: 15%;
            background-color: rgb(219, 218, 218);
            margin: 0 10px;
            margin-bottom: 20px;
            border-radius: 7px;
            padding: 5px;
        }
        .articles {
            width: 80%;
            background-color: #fff;
            overflow-y: scroll;
            border-radius: 7px;
            box-shadow: 0 0 8px gray;
          margin: 7% 0 0 5%;
        }
        .article {
            position: relative;
        }
        .title-section {
            width: 90%;
            /* height: 180px; */
            margin: 0 auto;
            text-align: center;
            position: relative;
        }
        .article__title {
            width: 100%;
            text-align: left;
            margin: 10% auto;
            margin-left: 20px;
            font-size: 35px;
            font-weight: 600;
        }
        .date {
            position: absolute;
            bottom: 20px;
            right: 30px;
            font-size: 15px;
            color: gray;
            border-bottom: 1px solid gray;
        }
        .article__tags {
            display: flex;
            justify-content: flex-start;
            align-items: flex-start;
        }
        .lgtm-button {
            width: 88%;
            margin: 15px auto;
            text-align: left;
        }
        .lgtm {
            width: 20%;
            height: 40px;
            border-radius: 0px;
            border: 4px solid #1587d3;
            color: #1587d3;
            font-size: 20px;
            font-weight: 600;
            letter-spacing: 4px;
            box-shadow: 0 0 8px gray;
        }
        .lgtm-count {
            color: #1587d3;
            font-size: 20px;
            font-weight: 800;
            margin-left: 10px;
        }
        .article__text {
            width: 88%;
            margin: 100px auto 0;
            text-align: left;
            font-size: 20px;
        }
        .isPushed {
            box-shadow: none;
            background-color: rgb(207, 204, 204);
        }
        #video_content {
            display: block;
            width: 70%;
            margin: 100px auto;
        }
        .nav {
                width: 50%
                }
            .doSearch {
                    color: #fff;
                    font-size: 12px;
                    width: 60px;
                    height: 25px;
                    margin-right: 30px;
                    box-shadow: 0 0 8px gray;
                    background-color: #1587D3;
                    border-radius: 7px;
                    border: 1px solid #222;
                    font-weight: 500;
            }
            .modal {
                width: 150px;
                height: 30px;
                background-color: rgb(106, 206, 236);
                box-shadow: 0 0 8px gray;
                position: absolute;
                top: 50px;
                right: 20px;
                border-radius: 7px;
                display: flex;
                left:90%;
            }
  .logout {
    justify-content: center;
    margin: 0 auto;
    text-align: center;
    color: #fff;
    font-size: 14px;
    font-weight: 600;
  }


      </style>
{% endblock %}